<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Cell Data with Bold Check</title>
</head>
<body>
    <input type="file" id="upload" />
    <div id="output"></div>

    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
    <script>
        function checktime(time, val, name, clas){
            if(time <= val){
                console.log("not ready")
                checktime(time, val, name, clas);
            }
            else{
                const not = new Notification(name + " has " + clas);
            }
        }
        var it = 0;
        var classes = "";
        var students = "";
        document.getElementById('upload').addEventListener('change', function(e) {
            var file = e.target.files[0];
            var reader = new FileReader();

            reader.onload = function(e) {
                var arrayBuffer = reader.result;
                var workbook = new ExcelJS.Workbook();

                workbook.xlsx.load(arrayBuffer).then(function() {
                    var worksheet = workbook.getWorksheet(1);
                    var output = '<table border="1">';

                    worksheet.eachRow({ includeEmpty: false }, function(row, rowNumber) {
                        output += '<tr>';
                        row.eachCell({ includeEmpty: false }, function(cell, colNumber) {
                            var cellValue = cell.value ? cell.value : '';
                            var cellStyle = '';

                            if (cell.font && cell.font.bold) {
                                cellStyle = 'font-weight:bold;';
                                classes += cellValue +  "," ;
                            }
                            if (cellValue.includes("{")) {
                                cellValue = cellValue.split("{")[1].split("}")[0];
                                alert(cellValue);

                                students += cellValue +  "," ;
                            }

                            output += '<td style="' + cellStyle + '">' + cellValue + '</td>';
                        });
                        output += '</tr>';
                        
                        output += "<input type='time' class='time'>"
                    });

                    output += '</table>';
                    document.getElementById('output').innerHTML = output;
                });
            };
            reader.readAsArrayBuffer(file);
            Notification.requestPermission();
            if (Notification.permission === "granted") {
                    document.querySelectorAll("input:time").forEach(input=> {
                        it++;
                       checktime(new Date().getTime().toString(), input.value, students.split(",")[it], classes.split(",")[it]);
                    })

             }
        });
    </script>
</body>
</html>
